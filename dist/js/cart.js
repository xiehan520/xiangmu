"use strict";!function(o){var i=!1,e=!1,t=!1;o("#signin").on("click",function(){o(".login-register").show().find(".login").show().next().hide(),o("input").not(":submit").val("").prevAll("input").focus()}),o(".close").on("click",function(){o(".login-register").hide(),o("input").not(":submit").val("")}),o(".toreg").on("click",function(){o(".login").hide().next().show(),o("input").not(":submit").val("").prevAll("input").focus()}),o(".log:password").on("focus",function(){o(".iconfont.b").css({color:"#5bc2d8"}),o(".wrong2").hide()}).on("blur",function(){o(".iconfont.b").css({color:"#e5e5e5"})}).prevAll(":text").on("focus",function(){o(".wrong1").hide()}).on("blur",function(){o.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkpe:o(".pe").val()},success:function(t){if(""!==o(".pe").val()){i=/^1[34578]\d{9}|(\w+[+-._]*\w+)\@(\w+[+-.]*\w+)\.(\w+[+-.]*\w+)$/.test(o(".pe").val())?t?(o(".wrong1").hide(),!0):(o(".wrong1").text("账号未注册，").append("<a href='#' class='toreg'>立即注册</b>").show(),!1):(o(".wrong1").text("账户有误，请重新输入").show(),!1)}else o(".wrong1").text("请输入丰趣海淘帐号").show(),i=!1}})}).parent().on("submit",function(){if(o.ajax({type:"post",url:"http://10.31.157.32/js-1907/xiangmu/php/login.php",data:{phone:o(".pe").val(),password:o(".log:password").val()},success:function(t){""!==o(".log:password").val()?t?(o(".wrong2").hide(),alert("登录成功！"),localStorage.setItem("customname",o(".pe").val()),location.href="http://10.31.157.32/js-1907/xiangmu/dist/cart.html"):(o(".wrong2").text("登录密码错误，请重新输入").show(),e=!1):(o(".wrong2").text("请输入密码").show(),e=!1)}}),!i||!e)return!1}),localStorage.getItem("customname")&&(o("#signin,#register").hide(),o("#hello").prepend(localStorage.getItem("customname")).show(),o("#quit").show().on("click",function(){localStorage.removeItem("customname"),o("#signin,#register").show(),o("#hello,#quit").hide(),location.href="http://10.31.157.32/js-1907/xiangmu/dist/cart.html"})),o("#register").on("click",function(){o(".login-register").show().find(".login").hide().next().show(),o("input").not(":submit").val("").prevAll(".phone").focus()}),o(".tologin").on("click",function(){o(".login").show().next().hide(),o("input").not(":submit").val("").prevAll("input").focus()}),o(".reg:password").on("focus",function(){o(".iconfont.b").css({color:"#5bc2d8"}),o(".tip3").hide()}).on("blur",function(){if(o(".iconfont.b").css({color:"#e5e5e5"}),""!==o(this).val()){t=/^(\w|[\w+-.,%=~!@#&'\<\>\?\(\)\*\/\$\^]){6,18}$/.test(o(this).val())?(o(".tip3").hide(),!0):(o(".tip3").text("密码请设置6-18位字母、数字或标点符号").show(),!1)}else o(".tip3").text("请设置登录密码").show(),t=!1}).prevAll(".email:text").on("focus",function(){o(".tip2").remove(".tologin").hide()}).on("blur",function(){o.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkemail:o(".email").val()},success:function(t){if(""!==o(".email").val()){e=/^(\w+[+-._]*\w+)\@(\w+[+-.]*\w+)\.(\w+[+-.]*\w+)$/.test(o(".email").val())?t?(o(".tip2").text("邮箱已存在，").append("<a href='#' class='tologin'>立即登录</b>").show(),!1):(o(".tip2").hide(),!0):(o(".tip2").text("您的邮箱格式有误").show(),!1)}else o(".tip2").text("请输入您的邮箱").show(),e=!1}})}).prevAll(".phone:text").on("focus",function(){o(".tip1").remove(".tologin").hide()}).on("blur",function(){o.ajax({type:"get",url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkphone:o(".phone").val()},success:function(t){if(""!==o(".phone").val()){i=/^1[34578]\d{9}$/.test(o(".phone").val())?t?(o(".tip1").text("手机号已存在，").append("<a href='#' class='tologin'>立即登录</b>").show(),!1):(o(".tip1").hide(),!0):(o(".tip1").text("您的手机号码格式有误").show(),!1)}else o(".tip1").text("请输入您的手机号码").show(),i=!1}})}).parent().on("submit",function(){if(!(i&&e&&t))return!1})}(jQuery),function(s){if(r.getcookie("cookiesid")&&r.getcookie("cookienum")){var i=r.getcookie("cookiesid").split(","),e=r.getcookie("cookienum").split(",");s.each(i,function(t,o){!function(n,c){s.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/hotlist1.php",dataType:"json"}).done(function(t){s.each(t,function(t,o){if(o.sid==n){var i=s(".tbody tr:hidden").clone(!0,!0);i.find("img").attr("src",o.bpicurl),i.find("img").attr("sid",o.sid),i.find(".title").html(o.title),i.find("b").html(o.price),i.find(".num").val(c);var e=(o.price*c).toFixed(2);i.find("strong").html(e),i.show(),s(".tbody").prepend(i)}}),h()})}(i[t],e[t])})}s(".allsel").on("click",function(){s(".tbody tr:visible").find("input:checkbox").prop("checked",s(this).prop("checked")),s(".allsel").prop("checked",s(this).prop("checked")),h()}),s(".tbody").on("click","input:checkbox",function(){s(".tbody tr:visible").find("input:checked").length==s(".tbody tr:visible").find("input:checkbox").length?s(".allsel").prop("checked",!0):s(".allsel").prop("checked",!1),0<s(".tbody tr:visible").find("input:checked").length?s(".tocal").css({background:"#df3c3a"}):s(".tocal").css({background:"#9e9e9e"}),h()}),s(".tbody").find(".down").on("click",function(){var t=s(this).next().val();--t<=1&&(t=1),s(this).next().val(t),s(this).parents("tr").find("strong").html((s(this).parents(".tbody").find("b").html()*t).toFixed(2)),h(),o(s(this))}),s(".tbody").find(".up").on("click",function(){var t=s(this).prev().val();t++,s(this).prev().val(t),s(this).parents("tr").find("strong").html((s(this).parents(".tbody").find("b").html()*t).toFixed(2)),h(),o(s(this))}),s(".num").on("input",function(){var t=parseInt(s(this).val());/^\d+$/g.test(t)?99<=t?s(this).val(99):t<=0?s(this).val(1):s(this).val(t):s(this).val(1),s(this).parents("tr").find("strong").html((s(this).parents(".tbody").find("b").html()*s(this).val()).toFixed(2)),h(),o(s(this))}),s(".tbody").on("click",".del",function(){l(),confirm("你确定要删除吗？")&&s(this).parents("tr").remove(),t(s(this).parents("tr").find("img").attr("sid"),n),h(),a()}),s(".delsle").on("click",function(){l(),confirm("你确定要删除吗？")&&(s(".tbody tr:visible").each(function(){s(this).find("input:checkbox").is(":checked")&&(s(this).remove(),t(s(this).find("img").attr("sid"),n))}),h(),a())});var n=[],c=[];function l(){r.getcookie("cookiesid")&&r.getcookie("cookienum")&&(n=r.getcookie("cookiesid").split(","),c=r.getcookie("cookienum").split(","))}function o(t){l();var o=t.parents(".tbody").find("img").attr("sid");console.log(o),c[s.inArray(o,n)]=t.parents(".tbody").find(".num").val(),r.addcookie("cookienum",c.toString(),10),console.log(t.parents(".tbody").find(".num").val())}function t(i,t){var e=-1;s.each(t,function(t,o){i==o&&(e=t)}),t.splice(e,1),c.splice(e,1),r.addcookie("cookiesid",t.toString(),10),r.addcookie("cookienum",c.toString(),10)}var r={addcookie:function(t,o,i){var e=new Date;e.setDate(e.getDate()+i),document.cookie=t+"="+encodeURIComponent(o)+";expires="+e},getcookie:function(t){var o=decodeURIComponent(document.cookie).split("; "),i=!0,e=!1,n=void 0;try{for(var c,s=o[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value.split("=");if(t===l[0])return l[1]}}catch(t){e=!0,n=t}finally{try{!i&&s.return&&s.return()}finally{if(e)throw n}}},delcookie:function(t){addcookie(t,"",-1)}};function a(){r.getcookie("cookiesid")&&r.getcookie("cookienum")?(s(".empty").hide(),s(".cartlist").show(),s(".cartfooter").show()):(s(".empty").show(),s(".cartlist").hide(),s(".cartfooter").hide(),r.addcookie("cookiesid","",-1),r.addcookie("cookienum","",-1))}function h(){var i=0,e=0;s(".tbody tr:visible").each(function(t,o){s(o).find("input:checkbox").is(":checked")&&(i+=parseInt(s(o).find("strong").html()),e+=parseInt(s(o).find(".num").val()))}),s(".count strong").html("￥"+i),s(".allnum").html(e)}a()}(jQuery);