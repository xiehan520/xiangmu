"use strict";!function(i){var o=!1,n=!1,t=!1;i("#signin").on("click",function(){i(".login-register").show().find(".login").show().next().hide(),i("input").not(":submit").val("").prevAll("input").focus()}),i(".close").on("click",function(){i(".login-register").hide(),i("input").not(":submit").val("")}),i(".toreg").on("click",function(){i(".login").hide().next().show(),i("input").not(":submit").val("").prevAll("input").focus()}),i(".log:password").on("focus",function(){i(".iconfont.b").css({color:"#5bc2d8"}),i(".wrong2").hide()}).on("blur",function(){i(".iconfont.b").css({color:"#e5e5e5"})}).prevAll(":text").on("focus",function(){i(".wrong1").hide()}).on("blur",function(){i.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkpe:i(".pe").val()},success:function(t){if(""!==i(".pe").val()){o=/^1[34578]\d{9}|(\w+[+-._]*\w+)\@(\w+[+-.]*\w+)\.(\w+[+-.]*\w+)$/.test(i(".pe").val())?t?(i(".wrong1").hide(),!0):(i(".wrong1").text("账号未注册，").append("<a href='#' class='toreg'>立即注册</b>").show(),!1):(i(".wrong1").text("账户有误，请重新输入").show(),!1)}else i(".wrong1").text("请输入丰趣海淘帐号").show(),o=!1}})}).parent().on("submit",function(){if(i.ajax({type:"post",url:"http://10.31.157.32/js-1907/xiangmu/php/login.php",data:{phone:i(".pe").val(),password:i(".log:password").val()},success:function(t){""!==i(".log:password").val()?t?(i(".wrong2").hide(),alert("登录成功！"),localStorage.setItem("customname",i(".pe").val()),location.href="http://10.31.157.32/js-1907/xiangmu/dist/cart.html"):(i(".wrong2").text("登录密码错误，请重新输入").show(),n=!1):(i(".wrong2").text("请输入密码").show(),n=!1)}}),!o||!n)return!1}),localStorage.getItem("customname")&&(i("#signin,#register").hide(),i("#hello").prepend(localStorage.getItem("customname")).show(),i("#quit").show().on("click",function(){localStorage.removeItem("customname"),i("#signin,#register").show(),i("#hello,#quit").hide(),location.href="http://10.31.157.32/js-1907/xiangmu/dist/cart.html"})),i("#register").on("click",function(){i(".login-register").show().find(".login").hide().next().show(),i("input").not(":submit").val("").prevAll(".phone").focus()}),i(".tologin").on("click",function(){i(".login").show().next().hide(),i("input").not(":submit").val("").prevAll("input").focus()}),i(".reg:password").on("focus",function(){i(".iconfont.b").css({color:"#5bc2d8"}),i(".tip3").hide()}).on("blur",function(){if(i(".iconfont.b").css({color:"#e5e5e5"}),""!==i(this).val()){t=/^(\w|[\w+-.,%=~!@#&'\<\>\?\(\)\*\/\$\^]){6,18}$/.test(i(this).val())?(i(".tip3").hide(),!0):(i(".tip3").text("密码请设置6-18位字母、数字或标点符号").show(),!1)}else i(".tip3").text("请设置登录密码").show(),t=!1}).prevAll(".email:text").on("focus",function(){i(".tip2").remove(".tologin").hide()}).on("blur",function(){i.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkemail:i(".email").val()},success:function(t){if(""!==i(".email").val()){n=/^(\w+[+-._]*\w+)\@(\w+[+-.]*\w+)\.(\w+[+-.]*\w+)$/.test(i(".email").val())?t?(i(".tip2").text("邮箱已存在，").append("<a href='#' class='tologin'>立即登录</b>").show(),!1):(i(".tip2").hide(),!0):(i(".tip2").text("您的邮箱格式有误").show(),!1)}else i(".tip2").text("请输入您的邮箱").show(),n=!1}})}).prevAll(".phone:text").on("focus",function(){i(".tip1").remove(".tologin").hide()}).on("blur",function(){i.ajax({type:"get",url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkphone:i(".phone").val()},success:function(t){if(""!==i(".phone").val()){o=/^1[34578]\d{9}$/.test(i(".phone").val())?t?(i(".tip1").text("手机号已存在，").append("<a href='#' class='tologin'>立即登录</b>").show(),!1):(i(".tip1").hide(),!0):(i(".tip1").text("您的手机号码格式有误").show(),!1)}else i(".tip1").text("请输入您的手机号码").show(),o=!1}})}).parent().on("submit",function(){if(!(o&&n&&t))return!1})}(jQuery),function(c){if(a("cookiesid")&&a("cookienum")){var o=a("cookiesid").split(","),n=a("cookienum").split(",");c.each(o,function(t,i){!function(e,s){c.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/hotlist1.php",dataType:"json"}).done(function(t){c.each(t,function(t,i){if(i.sid==e){var o=c(".tbody tr:hidden").clone(!0,!0);o.find("img").attr("src",i.bpicurl),o.find("img").attr("sid",i.sid),o.find(".title").html(i.title),o.find("b").html(i.price),o.find(".num").val(s);var n=(i.price*s).toFixed(2);o.find("strong").html(n),o.show(),c(".tbody").prepend(o)}}),p()})}(o[t],n[t])})}c(".allsel").on("click",function(){c(".tbody tr:visible").find("input:checkbox").prop("checked",c(this).prop("checked")),c(".allsel").prop("checked",c(this).prop("checked")),p()}),c(".tbody").on("click","input:checkbox",function(){c(".tbody tr:visible").find("input:checked").length==c(".tbody tr:visible").find("input:checkbox").length?c(".allsel").prop("checked",!0):c(".allsel").prop("checked",!1),0<c(".tbody tr:visible").find("input:checked").length?c(".tocal").css({background:"#df3c3a"}):c(".tocal").css({background:"#9e9e9e"}),p()}),c(".tbody").find(".down").on("click",function(){var t=c(this).next().val();--t<=1&&(t=1),c(this).next().val(t),c(this).parents("tr").find("strong").html((c(this).parents(".tbody").find("b").html()*t).toFixed(2)),p(),i(c(this))}),c(".tbody").find(".up").on("click",function(){var t=c(this).prev().val();t++,c(this).prev().val(t),c(this).parents("tr").find("strong").html((c(this).parents(".tbody").find("b").html()*t).toFixed(2)),p(),i(c(this))}),c(".num").on("input",function(){var t=parseInt(c(this).val());/^\d+$/g.test(t)?99<=t?c(this).val(99):t<=0?c(this).val(1):c(this).val(t):c(this).val(1),c(this).parents("tr").find("strong").html((c(this).parents(".tbody").find("b").html()*c(this).val()).toFixed(2)),p(),i(c(this))}),c(".tbody").on("click",".del",function(){l(),confirm("你确定要删除吗？")&&c(this).parents("tr").remove(),t(c(this).parents("tr").find("img").attr("sid"),e),p(),h()}),c(".delsle").on("click",function(){l(),confirm("你确定要删除吗？")&&(c(".tbody tr:visible").each(function(){c(this).find("input:checkbox").is(":checked")&&(c(this).remove(),t(c(this).find("img").attr("sid"),e))}),p(),h())});var e=[],s=[];function l(){a("cookiesid")&&a("cookienum")&&(e=a("cookiesid").split(","),s=a("cookienum").split(","))}function i(t){l();var i=t.parents(".tbody").find("img").attr("sid");console.log(i),s[c.inArray(i,e)]=t.parents(".tbody").find(".num").val(),r("cookienum",s.toString(),10),console.log(t.parents(".tbody").find(".num").val())}function t(o,t){var n=-1;c.each(t,function(t,i){o==i&&(n=t)}),t.splice(n,1),s.splice(n,1),r("cookiesid",t.toString(),10),r("cookienum",s.toString(),10)}function r(t,i,o){var n=new Date;n.setDate(n.getDate()+o),document.cookie=t+"="+encodeURIComponent(i)+";expires="+n}function a(t){var i=decodeURIComponent(document.cookie).split("; "),o=!0,n=!1,e=void 0;try{for(var s,c=i[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value.split("=");if(t===l[0])return l[1]}}catch(t){n=!0,e=t}finally{try{!o&&c.return&&c.return()}finally{if(n)throw e}}}function h(){a("cookiesid")&&a("cookienum")?(c(".empty").hide(),c(".cartlist").show(),c(".cartfooter").show()):(c(".empty").show(),c(".cartlist").hide(),c(".cartfooter").hide(),r("cookiesid","",-1),r("cookienum","",-1))}function p(){var o=0,n=0;c(".tbody tr:visible").each(function(t,i){c(i).find("input:checkbox").is(":checked")&&(o+=parseInt(c(i).find("strong").html()),n+=parseInt(c(i).find(".num").val()))}),c(".count strong").html("￥"+o),c(".allnum").html(n)}h()}(jQuery);