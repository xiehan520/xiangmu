"use strict";!function(n){n(window).on("scroll",function(){var t=n(this).scrollTop();600<=t?n("aside").stop(!0).animate({top:0,opacity:1}):n("aside").stop(!0).animate({top:-59,opacity:0}),600<=t?n(".totop").stop(!0).animate({opacity:1}).show():n(".totop").stop(!0).animate({opacity:0},function(){n(this).hide()})}),n(".totop").hover(function(){n(this).css({background:"rgba(0, 0, 0, 0.5)"})},function(){n(this).css({background:"rgba(0, 0, 0, 0.3)"})}).on("click",function(){n("html,body").stop(!0).animate({scrollTop:0})});var o=!1,i=!1,t=!1;n("#signin").on("click",function(){n(".login-register").show().find(".login").show().next().hide(),n("input").not(":submit").val("").prevAll("input").focus()}),n(".close").on("click",function(){n(".login-register").hide(),n("input").not(":submit").val("")}),n(".toreg").on("click",function(){n(".login").hide().next().show(),n("input").not(":submit").val("").prevAll("input").focus()}),n(".log:password").on("focus",function(){n(".iconfont.b").css({color:"#5bc2d8"}),n(".wrong2").hide()}).on("blur",function(){n(".iconfont.b").css({color:"#e5e5e5"})}).prevAll(":text").on("focus",function(){n(".wrong1").hide()}).on("blur",function(){n.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkpe:n(".pe").val()},success:function(t){if(""!==n(".pe").val()){o=/^1[34578]\d{9}|(\w+[+-._]*\w+)\@(\w+[+-.]*\w+)\.(\w+[+-.]*\w+)$/.test(n(".pe").val())?t?(n(".wrong1").hide(),!0):(n(".wrong1").text("账号未注册，").append("<a href='#' class='toreg'>立即注册</b>").show(),!1):(n(".wrong1").text("账户有误，请重新输入").show(),!1)}else n(".wrong1").text("请输入丰趣海淘帐号").show(),o=!1}})}).parent().on("submit",function(){if(n.ajax({type:"post",url:"http://10.31.157.32/js-1907/xiangmu/php/login.php",data:{phone:n(".pe").val(),password:n(".log:password").val()},success:function(t){""!==n(".log:password").val()?t?(n(".wrong2").hide(),alert("登录成功！"),localStorage.setItem("customname",n(".pe").val()),location.href="http://10.31.157.32/js-1907/xiangmu/dist/detail.html"):(n(".wrong2").text("登录密码错误，请重新输入").show(),i=!1):(n(".wrong2").text("请输入密码").show(),i=!1)}}),!o||!i)return!1}),localStorage.getItem("customname")&&(n("#signin,#register").hide(),n("#hello").prepend(localStorage.getItem("customname")).show(),n("#quit").show().on("click",function(){localStorage.removeItem("customname"),n("#signin,#register").show(),n("#hello,#quit").hide(),location.href="http://10.31.157.32/js-1907/xiangmu/dist/detail.html"})),n("#register").on("click",function(){n(".login-register").show().find(".login").hide().next().show(),n("input").not(":submit").val("").prevAll(".phone").focus()}),n(".tologin").on("click",function(){n(".login").show().next().hide(),n("input").not(":submit").val("").prevAll("input").focus()}),n(".reg:password").on("focus",function(){n(".iconfont.b").css({color:"#5bc2d8"}),n(".tip3").hide()}).on("blur",function(){if(n(".iconfont.b").css({color:"#e5e5e5"}),""!==n(this).val()){t=/^(\w|[\w+-.,%=~!@#&'\<\>\?\(\)\*\/\$\^]){6,18}$/.test(n(this).val())?(n(".tip3").hide(),!0):(n(".tip3").text("密码请设置6-18位字母、数字或标点符号").show(),!1)}else n(".tip3").text("请设置登录密码").show(),t=!1}).prevAll(".email:text").on("focus",function(){n(".tip2").remove(".tologin").hide()}).on("blur",function(){n.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkemail:n(".email").val()},success:function(t){if(""!==n(".email").val()){i=/^(\w+[+-._]*\w+)\@(\w+[+-.]*\w+)\.(\w+[+-.]*\w+)$/.test(n(".email").val())?t?(n(".tip2").text("邮箱已存在，").append("<a href='#' class='tologin'>立即登录</b>").show(),!1):(n(".tip2").hide(),!0):(n(".tip2").text("您的邮箱格式有误").show(),!1)}else n(".tip2").text("请输入您的邮箱").show(),i=!1}})}).prevAll(".phone:text").on("focus",function(){n(".tip1").remove(".tologin").hide()}).on("blur",function(){n.ajax({type:"get",url:"http://10.31.157.32/js-1907/xiangmu/php/register.php",data:{checkphone:n(".phone").val()},success:function(t){if(""!==n(".phone").val()){o=/^1[34578]\d{9}$/.test(n(".phone").val())?t?(n(".tip1").text("手机号已存在，").append("<a href='#' class='tologin'>立即登录</b>").show(),!1):(n(".tip1").hide(),!0):(n(".tip1").text("您的手机号码格式有误").show(),!1)}else n(".tip1").text("请输入您的手机号码").show(),o=!1}})}).parent().on("submit",function(){if(!(o&&i&&t))return!1});var e=location.search.substring(1).split("=")[1];n.ajax({url:"http://10.31.157.32/js-1907/xiangmu/php/detail.php",data:{sid:e},dataType:"json"}).done(function(t){var o=t.urls.split(",");n(".simg img").attr("src",t.bpicurl),n(".bimg .bbimg").attr("sid",t.sid),n(".bimg .bbimg").attr("src",o[0]),n(".goods-right .dic2 img").attr("src",t.spicurl),n(".goods-right h2").text(t.title),n("#src .tip").text(t.title),n("title").text("【丰趣海淘】"+t.title+"，丰趣海淘！"),n(".brand").text(t.brand),n(".goodsprice1").text(t.price),n(".goodsprice2").text(t.delprice);var i="";n.each(o,function(t,o){i+='\n            <li><img src="'+o+'" alt="" ></li>\n            '}),n(".simg ul").html(i)});var s=[],a=[];function c(t,o,i){var n=new Date;n.setDate(n.getDate()+i),document.cookie=t+"="+encodeURIComponent(o)+";expires="+n}function r(t){var o=decodeURIComponent(document.cookie).split("; "),i=!0,n=!1,e=void 0;try{for(var s,a=o[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value.split("=");if(t===c[0])return c[1]}}catch(t){n=!0,e=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw e}}}var l=0;n(".add").on("click",function(){var t=n(".bimg .img2").attr("sid");if(r("cookiesid")&&r("cookienum")&&(s=r("cookiesid").split(","),a=r("cookienum").split(","),n.each(a,function(t,o){l+=parseInt(o),console.log(l)})),-1!==n.inArray(t,s)){var o=parseInt(a[n.inArray(t,s)])+parseInt(n("#count").val());a[n.inArray(t,s)]=o,c("cookienum",a.toString(),10)}else s.push(t),c("cookiesid",s.toString(),10),a.push(n("#count").val()),c("cookienum",a.toString(),10)}),n(".simg ul").find("li").eq(0).addClass("red"),n(".simg ul").on("click","li",function(){var t=n(this).find("img").attr("src");n(this).addClass("red").siblings().removeClass("red"),n(".bimg img").attr({src:t})}),n(".bimg").hover(function(){n(".img2").stop(!0).animate({opacity:0}).hide().prev().show().stop(!0).animate({opacity:1});var o=n(".bimg").width()/n(".img1").width();n(".bimg").on("mousemove",function(t){n(".img1").css({top:-t.offsetY*o,left:-t.offsetX*o})})},function(){n(".img1").stop(!0).animate({opacity:0}).hide().next().show().stop(!0).animate({opacity:1})}),n(".goods-right").find("ol li a").on("click",function(){n(this).addClass("red").append("<span></span>").siblings().removeClass("red").find("span").detach("span")}),n(".goods-right").find(".more").on("click",function(){"block"==n(".goods-yh2").css("display")?n(".goods-yh2").hide():n(".goods-yh2").show()}),n(".goods-right").find(".down").on("click",function(){var t=n(this).next().val();isNaN(t)?n(this).next().val("NaN"):2<=--t?n(this).next().val(t):n(this).next().val(1)}),n(".goods-right").find(".up").on("click",function(){var t=n(this).prev().val();isNaN(t)?n(this).prev().val("NaN"):(t++,n(this).prev().val(t))})}(jQuery);